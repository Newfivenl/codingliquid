{%- liquid
  assign columns_mobile_int = section.settings.columns_mobile | plus: 0
-%}

<div class="{% if section.settings.background_style == 'primary' %}tw-bg-gray-100{% endif %} tw-py-8 tw-md:py-12">
  <div class="tw-max-w-7xl tw-mx-auto tw-px-4 tw-sm:px-6 tw-lg:px-8">
    {%- unless section.settings.title == blank -%}
        {%- case section.settings.heading_tag -%} 
        {%- when 'h1' -%}
            <h1 class="h1 tw-mb-[3rem]">{{ section.settings.title }}</h1>
        {%- when 'h2' -%}
            <h2 class="h2 tw-mb-[3rem]">{{ section.settings.title }}</h2>
        {%- when 'h3' -%}
            <h3 class="h3 tw-mb-[3rem]">{{ section.settings.title }}</h3>
        {%- endcase -%}
    {%- endunless -%}

    <div class="tw-grid tw-gap-6" 
      style="grid-template-columns: repeat({{ section.settings.columns_desktop }}, minmax(0, 1fr));"
      data-columns-mobile="{{ section.settings.columns_mobile }}"
      data-columns-desktop="{{ section.settings.columns_desktop }}"
    >
    {%- for block in section.blocks -%}
        {%- assign qa_object = block.settings.questions_and_answers -%}
        
        <div class="tw-flex tw-flex-col {% if section.settings.column_alignment == 'center' %}tw-items-center tw-text-center{% endif %}" 
          {{ block.shopify_attributes }}
        >
          {%- if qa_object.title.value != blank or qa_object.questions_and_answers.icon != blank -%}
            {{ qa_object.questions_and_answers.icon.value }}
            <div class="tw-flex tw-items-center tw-gap-3 tw-mb-4 {% if section.settings.column_alignment == 'center' %}tw-justify-center{% endif %}">
              {%- if qa_object.questions_and_answers.icon != blank -%}
                {{ qa_object.questions_and_answers.icon | image_url: width: 40 | image_tag:
                    loading: 'lazy',
                    class: 'tw-w-10 tw-h-10 tw-object-contain'
                }}
              {%- endif -%}
              {%- if qa_object.title.value != blank -%}
                <h3 class="tw-text-xl tw-font-semibold tw-text-gray-900">{{ qa_object.title.value }}</h3>
              {%- endif -%}
            </div>
          {%- endif -%}
      
          {%- if qa_object.questions_and_answers.value != blank -%}
            {%- assign qa_items = qa_object.questions_and_answers.value | json_parse -%}
            
            {%- for item in qa_items -%}
              <div class="tw-mb-4 last:tw-mb-0">
                {%- if item.question != blank -%}
                  <h4 class="tw-text-lg tw-font-medium tw-text-gray-900 tw-mb-2">{{ item.question }}</h4>
                {%- endif -%}
      
                {%- if item.answer != blank -%}
                  <div class="tw-text-gray-600">{{ item.answer }}</div>
                {%- endif -%}
              </div>
            {%- endfor -%}
          {%- endif -%}
        </div>
      {%- endfor -%}
      
    </div>
  </div>
</div>

<style>
@media screen and (max-width: 749px) {
  [data-columns-mobile="1"] {
    grid-template-columns: repeat(1, minmax(0, 1fr)) !important;
  }
  
  [data-columns-mobile="2"] {
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
  }
}
</style>

{% schema %}
{
  "name": "TW - Question & Answer",
  "tag": "section",
  "class": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "inline_richtext",
      "id": "title",
      "label": "Heading",
      "default": "Questions & Answers"
    },
    {
        "type": "select",
        "id": "heading_tag",
        "label": "Heading Tag",
        "default": "h1",
        "options": [
            {
                "value": "h1",
                "label": "H1"
            },
            {
                "value": "h2",
                "label": "H2"
            },
            {
                "value": "h3",
                "label": "H3"
            }
        ]
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 1,
      "max": 6,
      "step": 1,
      "default": 3,
      "label": "Number of columns on desktop"
    },
    {
      "type": "select",
      "id": "column_alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        }
      ],
      "default": "left",
      "label": "Column alignment"
    },
    {
      "type": "select",
      "id": "background_style",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "primary",
          "label": "Primary"
        }
      ],
      "default": "none",
      "label": "Background style"
    },
    {
      "type": "select",
      "id": "columns_mobile",
      "options": [
        {
          "value": "1",
          "label": "1 column"
        },
        {
          "value": "2",
          "label": "2 columns"
        }
      ],
      "default": "1",
      "label": "Number of columns on mobile"
    }
  ],
  "blocks": [
    {
      "type": "metaobject",
      "name": "Q&A lists",
      "settings": [
        {
          "type": "metaobject",
          "id": "questions_and_answers",
          "label": "Questions & Answers",
          "metaobject_type": "questions_and_answers"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "TW - Questions & Answers",
      "blocks": [
        {
          "type": "metaobject"
        },
        {
          "type": "metaobject"
        },
        {
          "type": "metaobject"
        }
      ]
    }
  ]
}
{% endschema %}