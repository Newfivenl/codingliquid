{%- style -%}

  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }
  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

{%- endstyle -%}

{%- liquid 
            
assign fetch_priority = 'auto'
if section.index == 1
    assign fetch_priority = 'high'
endif

assign image_blocks = section.blocks | where: 'type', 'image'
assign widths = '375, 550, 750, 800, 1100, 1500, 1780, 2048, 3000, 3840'
assign image_class = 'tw-w-full tw-h-auto tw-object-cover'

-%}

<section class="section-{{ section.id }}-padding gradient color-{{ section.settings.content_color_scheme }}">

  {% for block in section.blocks %}
    {%  case block.type  %}  
    {%  when 'image' %}
      {% if block.settings.link != blank %}
      <a href="{{ block.settings.link }}" class="tw-block tw-w-full tw-h-full">
      {% endif %}
        <div class="tw-relative">
          <picture>
            {% if block.settings.image_desktop != blank %}
              <div class="tw-full-image-desktop {% if block.settings.image_mobile != blank %} max-[989px]:tw-hidden {% endif %}">
                {{ block.settings.image_desktop | image_url: width: 2048 | image_tag: class: image_class, alt: block.settings.image_desktop.alt, widths: widths, fetchpriority: fetch_priority }}
              </div>
              {% if block.settings.image_mobile != blank %}
                <div class="tw-full-image-mobile tw-hidden max-[989px]:tw-block">
                  {{ block.settings.image_mobile| image_url: width: 800 | image_tag: class: image_class, alt: block.settings.image_mobile.alt, widths: widths, fetchpriority: fetch_priority }}
                </div>
              {% endif %}
            {% else %}
              {{ 'hero-apparel-1' | placeholder_svg_tag: 'placeholder-svg' }}
            {% endif %}
          </picture>
          <div class="tw-absolute tw-top-0 tw-bottom-0 tw-left-0 tw-w-full">
            <div class="tw-sticky tw-top-0 tw-z-[1] tw-h-full tw-max-h-screen">
              <div class="tw-flex tw-items-center tw-h-full lg:tw-items-end ">
                <div class="tw-sticky lg:tw-static tw-top-[calc(50%_-_0.5em_*_1.02)] tw-text-left tw-w-full tw-z-30 tw-pointer-events-none tw-p-[5rem] max-[640px]:!tw-pb-[2rem] gradient color-{{ block.settings.content_color_scheme }}">
                  {% if block.settings.heading != blank %}
                    {% style %}
                      .h2-{{ block.id }} {
                        font-size: {{ block.settings.heading_size }}px;
                        line-height: {{ block.settings.heading_size }}px;
                      }
                      .h3-{{ block.id }} {
                        font-size: {{ block.settings.subheading_size }}px;
                        line-height: {{ block.settings.subheading_size }}px;
                        margin-top: 1rem;
                        margin-left: 1rem;
                      }
                      @media screen and (max-width: 989px) {
                        .h2-{{ block.id }} {
                          font-size: calc({{ block.settings.heading_size }}px * 0.5);
                          line-height: calc({{ block.settings.heading_size }}px * 0.5);
                        }
                        .h3-{{ block.id }} {
                          font-size: calc({{ block.settings.subheading_size }}px * 0.5);
                          line-height: calc({{ block.settings.subheading_size }}px * 0.5);
                        }
                      }
                      @media screen and (max-width: 640px) {
                        .h2-{{ block.id }} {
                          font-size: calc({{ block.settings.heading_size }}px * 0.2);
                          line-height: calc({{ block.settings.heading_size }}px * 0.2);
                        }
                        .h3-{{ block.id }} {
                          font-size: calc({{ block.settings.subheading_size }}px * 0.2);
                          line-height: calc({{ block.settings.subheading_size }}px * 0.2);
                          margin-left: .5rem;
                        }
                      }
                    {% endstyle %}
                    <h2 class="h2-{{ block.id }}">{{ block.settings.heading }}</h2>
                    <h3 class="h3-{{ block.id }}">{{ block.settings.subheading }}</h3>
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        </div>
      {% if block.settings.link != blank %}
      </a>
      {% endif %}
    {%  when 'video' %}
      {% if block.settings.video != blank %}
        <div class="tw-relative">
          <!-- Video Element -->

         {% assign my_video_1 = "my-video-1-" | append: block.id %}
         {% assign my_video_2 = "my-video-2-" | append: block.id %}
         {{
            block.settings.video | video_tag:
              image_size: '800',
              autoplay: true,
              loop: true,
              controls: false,
              muted: true,
              id: my_video_1,
              class: "tw-w-full tw-h-full tw-object-cover tw-object-center"
          }}
          {{
            block.settings.video | 
            video_tag:
              image_size: '800',
              autoplay: true,
              loop: true,
              controls: false,
              muted: true,
              id: my_video_2,
              class: "tw-w-full tw-h-full tw-object-cover tw-object-center" | 
            replace: '<video', '<picture' | 
            replace: '</video', '</picture' | 
            replace: '<source src', '<source srcset'
          }}
          <script>
          const userAgentMyVideo = navigator.userAgent;

          const myVideo1 = document.getElementById("{{ my_video_1 }}");
          const myVideo2 = document.getElementById("{{ my_video_2 }}");
          const myVideo2Img = myVideo2.querySelector("img");
          myVideo2.getAttribute("class").split(" ").forEach(className => {
              myVideo2Img.classList.add(className);
          });

          if (userAgentMyVideo.includes("Safari") && !userAgentMyVideo.includes("Chrome")) {
            myVideo2.style.display = "block";
            myVideo1.style.display = "none";
          } else {
            myVideo2.style.display = "none";
            myVideo1.style.display = "block";
            myVideo1.play();
          } 
          </script>
         
          
          <div class="tw-absolute tw-top-0 tw-bottom-0 tw-left-0 tw-w-full">
            <div class="tw-sticky tw-top-0 tw-z-[1] tw-h-full tw-max-h-screen">
              <div class="tw-flex tw-items-center tw-h-full lg:tw-items-end ">
                <div class="tw-sticky lg:tw-static tw-top-[calc(50%_-_0.5em_*_1.02)] tw-text-left tw-w-full tw-z-30 tw-pointer-events-none tw-p-[5rem] max-[640px]:!tw-pb-[2rem] gradient color-{{ block.settings.content_color_scheme }}">
                  {% if block.settings.heading != blank %}
                    {% style %}
                      .h2-{{ block.id }} {
                        font-size: {{ block.settings.heading_size }}px;
                        line-height: {{ block.settings.heading_size }}px;
                      }
                      .h3-{{ block.id }} {
                        font-size: {{ block.settings.subheading_size }}px;
                        line-height: {{ block.settings.subheading_size }}px;
                        margin-top: 1rem;
                        margin-left: 1rem;
                      }
                      @media screen and (max-width: 989px) {
                        .h2-{{ block.id }} {
                          font-size: calc({{ block.settings.heading_size }}px * 0.5);
                          line-height: calc({{ block.settings.heading_size }}px * 0.5);
                        }
                        .h3-{{ block.id }} {
                          font-size: calc({{ block.settings.subheading_size }}px * 0.5);
                          line-height: calc({{ block.settings.subheading_size }}px * 0.5);
                        }
                      }
                      @media screen and (max-width: 640px) {
                        .h2-{{ block.id }} {
                          font-size: calc({{ block.settings.heading_size }}px * 0.2);
                          line-height: calc({{ block.settings.heading_size }}px * 0.2);
                        }
                        .h3-{{ block.id }} {
                          font-size: calc({{ block.settings.subheading_size }}px * 0.2);
                          line-height: calc({{ block.settings.subheading_size }}px * 0.2);
                          margin-left: .5rem;
                        }
                      }
                    {% endstyle %}
                    <h2 class="h2-{{ block.id }}">{{ block.settings.heading }}</h2>
                    <h3 class="h3-{{ block.id }}">{{ block.settings.subheading }}</h3>
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        </div>
        
        {% endif %}
    {% endcase %}
  {% endfor %}

</section>

{% schema %}
{
    "name": "Full image/video w/ text",
    "settings": [
        {
          "type": "color_scheme",
          "id": "section_color_scheme",
          "label": "Color scheme",
          "default": "scheme-1"
        },
        {
          "type": "range",
          "id": "padding_top",
          "min": 0,
          "max": 100,
          "step": 4,
          "unit": "px",
          "label": "Padding top",
          "default": 12
        },
        {
          "type": "range",
          "id": "padding_bottom",
          "min": 0,
          "max": 100,
          "step": 4,
          "unit": "px",
          "label": "Padding bottom",
          "default": 12
        }
    ],
    "blocks": [
      {
        "type": "image",
        "name": "Image",
        "limit": 1,
        "settings": [
          {
            "type": "image_picker",
            "id": "image_desktop",
            "label": "Image desktop",
            "info": "Use portrait image and high resolution (2048 × 2560) for better layout"
          },
          {
            "type": "image_picker",
            "id": "image_mobile",
            "label": "Image moible",
             "info": "Use portrait image and high resolution (800 × 1400) for better layout"
          },
          {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "Heading"
          },
          {
            "type":"range",
            "id":"heading_size",
            "min":10,
            "max":1000,
            "step":10,
            "unit":"px",
            "label":"Heading size",
            "default":30
          },
          {
            "type": "text",
            "id": "subheading",
            "label": "Subheading",
            "default": "Subheading"
          },
          {
            "type": "range",
            "id": "subheading_size",
            "min":10,
            "max":1000,
            "step":10,
            "unit": "px",
            "label": "Subheading size",
            "default": 20
          },
          {
            "type": "url",
            "id": "link",
            "label": "Section link"
          },
          {
            "type": "color_scheme",
            "id": "content_color_scheme",
            "label": "Color scheme",
            "default": "scheme-1"
          }
        ]
      },
      {
        "type": "video",
        "name": "Video",
        "limit": 1,
        "settings": [
          {
            "type": "paragraph",
            "content": "Use portrait video for better layout"
          },
          {
            "type": "video",
            "id": "video",
            "label": "Video",
            "info": "Use portrait video (800 × 1400) for better layout"
          },
          {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "Heading"
          },
          {
            "type":"range",
            "id":"heading_size",
            "min":10,
            "max":1000,
            "step":10,
            "unit":"px",
            "label":"Heading size",
            "default":30
          },
          {
            "type": "text",
            "id": "subheading",
            "label": "Subheading",
            "default": "Subheading"
          },
          {
            "type": "range",
            "id": "subheading_size",
            "min":10,
            "max":1000,
            "step":10,
            "unit": "px",
            "label": "Subheading size",
            "default": 20
          },
          {
            "type": "url",
            "id": "link",
            "label": "Section link"
          },
          {
            "type": "color_scheme",
            "id": "content_color_scheme",
            "label": "Color scheme",
            "default": "scheme-1"
          }
        ]
      }
    ],
    "presets": [
        {
          "name": "Full image/video w/ text",
          "blocks": [
            {
              "type": "image"
            }
          ]
        }
    ]
}
{% endschema %}